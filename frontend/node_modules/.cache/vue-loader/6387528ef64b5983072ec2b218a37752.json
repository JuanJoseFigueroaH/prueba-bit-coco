{"remainingRequest":"C:\\laragon\\www\\project-corhuila\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\project-corhuila\\frontend\\src\\components\\Venta.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\laragon\\www\\project-corhuila\\frontend\\src\\components\\Venta.vue","mtime":1617727454173},{"path":"C:\\laragon\\www\\project-corhuila\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1642907172876},{"path":"C:\\laragon\\www\\project-corhuila\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1642907173684},{"path":"C:\\laragon\\www\\project-corhuila\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1642907173882},{"path":"C:\\laragon\\www\\project-corhuila\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1642907172876},{"path":"C:\\laragon\\www\\project-corhuila\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1642907175054}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from 'axios'\nimport jsPDF from 'jspdf'\nimport html2canvas from 'html2canvas';\nexport default {\n    data(){\n        return{\n            dialog: false,\n            search:'',\n            ventas:[],\n            headers: [\n                { text: 'Opciones', value: 'opciones', sortable: false },\n                { text: 'Usuario', value: 'usuario.nombre', sortable: true },\n                { text: 'Cliente', value: 'persona.nombre', sortable: true },\n                { text: 'Tipo Comprobante', value: 'tipo_comprobante', sortable: true },\n                { text: 'Serie comprobante', value: 'serie_comprobante', sortable: false  },\n                { text: 'Número comprobante', value: 'num_comprobante', sortable: false  },\n                { text: 'Fecha', value: 'createdAt', sortable: false  },\n                { text: 'Impuesto', value: 'impuesto', sortable: false  },\n                { text: 'Total', value: 'total', sortable: false  },\n                { text: 'Estado', value: 'estado', sortable: false  }                \n            ],\n            _id:'',\n            persona:'',\n            personas:[],\n            tipo_comprobante:'',\n            comprobantes: ['BOLETA','FACTURA','TICKET','GUIA'],\n            serie_comprobante:'',\n            num_comprobante: '',\n            impuesto: 0.18,\n            codigo:'',\n            cabeceraDetalles:[\n                { text: 'Borrar', value: 'borrar', sortable: false },\n                { text: 'Artículo', value: 'articulo', sortable: false },\n                { text: 'Cantidad', value: 'cantidad', sortable: false },\n                { text: 'Precio', value: 'precio', sortable: false },\n                { text: 'Descuento', value: 'descuento', sortable: false },\n                { text: 'Sub Total', value: 'subtotal', sortable: false  }\n            ],\n            detalles:[],\n            verNuevo:0,\n            errorArticulo:null,\n            total:0,\n            totalParcial:0,\n            totalImpuesto:0,\n            articulos:[],\n            texto:'',\n            cabeceraArticulos: [\n                { text: 'Seleccionar', value: 'seleccionar', sortable: false },\n                { text: 'Código',value: 'codigo', sortable: false},\n                { text: 'Nombre',value: 'nombre', sortable: true},\n                { text: 'Categoría',value: 'categoria.nombre', sortable: true},\n                { text: 'Stock',value: 'stock', sortable: false},\n                { text: 'Precio Venta',value: 'precio_venta', sortable: false},\n                { text: 'Descripción', value: 'descripcion', sortable: false },              \n                { text: 'Estado', value: 'estado', sortable: false }\n            ],\n            verDetalle:0,\n            valida:0,\n            validaMensaje:[],\n            adModal:0,\n            adAccion:0,\n            adNombre:'',\n            adId:'',\n            comprobanteModal:0,\n            fecha:null\n        }\n    },\n    computed: {\n        calcularTotal: function(){\n            let resultado=0.0;\n            for(var i=0;i<this.detalles.length;i++){\n                resultado=resultado+((this.detalles[i].cantidad*this.detalles[i].precio)-this.detalles[i].descuento);\n            }\n            return resultado;\n        }\n    },\n    watch: {\n        dialog (val) {\n        val || this.close()\n        }\n    },\n    created () {\n        this.listar();\n        this.selectPersona();\n    },\n    methods: {\n        crearPDF(){\n            var quotes = document.getElementById('factura');\n            html2canvas(quotes).then(function (canvas) {\n                var imgData = canvas.toDataURL('image/png');\n                var imgWidth = 210;\n                var pageHeight = 295;\n\n                var imgHeight = canvas.height * imgWidth / canvas.width;\n                var heightLeft = imgHeight;\n                \n                var doc = new jsPDF('p', 'mm', 'a4');\n                var position = 0;\n\n                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n                heightLeft -= pageHeight;\n\n                while (heightLeft >= 0) {\n                    position = heightLeft - imgHeight;\n                    doc.addPage();\n                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n                    heightLeft -= pageHeight;\n                }\n                doc.save('ComprobanteVenta.pdf');\n            });\n        },\n        mostrarComprobante(item){\n            this.limpiar();\n            this.tipo_comprobante=item.tipo_comprobante;\n            this.serie_comprobante=item.serie_comprobante;\n            this.num_comprobante=item.num_comprobante;\n            this.fecha=item.createdAt;\n            this.persona=item.persona;\n            this.impuesto=item.impuesto;\n            this.listarDetalles(item._id);\n            this.comprobanteModal=1;\n        },\n        ocultarComprobante(){\n            this.comprobanteModal=0;\n        },\n        selectPersona(){\n            let me=this;\n            let personaArray=[];\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};            \n            axios.get('persona/listClientes',configuracion).then(function (response){\n                personaArray=response.data;\n                personaArray.map(function(x){\n                    me.personas.push({text:x.nombre, value:x._id});\n                });\n            }).catch(function(error){\n                console.log(error);\n            });\n        },\n        buscarCodigo(){\n            let me=this;\n            me.errorArticulo=null;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};            \n            axios.get('articulo/queryCodigo?codigo='+this.codigo,configuracion).then(function (response){\n                me.agregarDetalle(response.data);\n            }).catch(function(error){\n                me.errorArticulo='No existe el artículo.';\n            });\n        },\n        agregarDetalle(data){\n            this.errorArticulo=null;\n            if (this.encuentra(data._id)==true){\n                this.errorArticulo='El artículo ya ha sido agregado.';\n            }\n            else{\n                this.detalles.push(\n                    {\n                        _id:data._id,\n                        articulo:data.nombre,\n                        cantidad:1,\n                        precio:data.precio_venta,\n                        descuento:0\n                    }\n                );\n                this.codigo='';\n            }\n            \n        },\n        encuentra(id){\n            let sw=0;\n            for (var i=0;i<this.detalles.length;i++){\n                if(this.detalles[i]._id==id){\n                    sw=true;\n                }\n            }\n            return sw;\n        },\n        eliminarDetalle(arr,item){\n            let i=arr.indexOf(item);\n            if (i!= -1){\n                arr.splice(i,1);\n            }\n        },\n        listarArticulos(){\n            let me=this;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};            \n            axios.get('articulo/list?valor='+this.texto,configuracion).then(function (response){\n                console.log(response.data);\n                me.articulos=response.data;\n            }).catch(function(error){\n                console.log(error);\n            });\n        },\n        mostrarModalArticulos(){\n            this.dialog=1;\n        },\n        listarDetalles(id){\n            let me=this;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};            \n            axios.get('venta/query?_id='+id,configuracion).then(function (response){\n                me.detalles=response.data.detalles;\n            }).catch(function(error){\n                console.log(error);\n            });\n        },\n        verIngreso(item){\n            this.limpiar();\n            this.tipo_comprobante=item.tipo_comprobante;\n            this.serie_comprobante=item.serie_comprobante;\n            this.num_comprobante=item.num_comprobante;\n            this.persona=item.persona._id;\n            this.impuesto=item.impuesto;\n            this.listarDetalles(item._id);\n            this.verNuevo=1;\n            this.verDetalle=1;\n        },\n        listar(){\n            let me=this;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};            \n            axios.get('venta/list',configuracion).then(function (response){\n                me.ventas=response.data;\n            }).catch(function(error){\n                console.log(error);\n            });\n\n        },\n        limpiar(){\n            this._id='';\n            this.tipo_comprobante='';\n            this.serie_comprobante='';\n            this.num_comprobante='';\n            this.impuesto=0.18;\n            this.codigo='';\n            this.total=0;\n            this.totalParcial=0;\n            this.totalImpuesto=0;\n            this.detalles=[];\n            this.verNuevo=0;\n            this.valida=0;\n            this.validaMensaje=[];\n            this.verDetalle=0;\n        },\n        validar(){\n            this.valida=0;\n            this.validaMensaje=[];\n            if(!this.persona){\n                this.validaMensaje.push('Seleccione un cliente.');\n            }\n            if(!this.tipo_comprobante){\n                this.validaMensaje.push('Seleccione un tipo de comprobante.');\n            }\n            if(!this.num_comprobante){\n                this.validaMensaje.push('Ingrese el número del comprobante.');\n            }\n            if(!this.impuesto || this.impuesto<0 || this.impuesto>1){\n                this.validaMensaje.push('Ingrese un impuesto válido.');\n            }\n            if(this.detalles.length<=0){\n                this.validaMensaje.push('Ingrese al menos un artículo al detalle');\n            }\n            if (this.validaMensaje.length){\n                this.valida=1;\n            }\n            return this.valida;\n        },\n        mostrarNuevo(){\n            this.verNuevo=1;\n        },\n        ocultarNuevo(){\n            this.verNuevo=0;\n            this.limpiar();\n        },\n        guardar(){\n            let me=this;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};\n            if (this.validar()){\n                return;\n            }\n            //Código para guardar\n            axios.post('venta/add',\n            {\n                'persona':this.persona,\n                'usuario':this.$store.state.usuario._id,\n                'tipo_comprobante': this.tipo_comprobante,\n                'serie_comprobante': this.serie_comprobante,\n                'num_comprobante':this.num_comprobante,\n                'impuesto': this.impuesto,\n                'total':this.total,\n                'detalles':this.detalles\n            },configuracion)\n            .then(function(response){\n                me.limpiar();\n                me.close();\n                me.listar();\n            })\n            .catch(function(error){\n                console.log(error);\n            });\n        },\n        activarDesactivarMostrar(accion,item){\n            this.adModal=1;\n            this.adNombre=item.num_comprobante;\n            this.adId=item._id;\n            if (accion==1){\n                this.adAccion=1;\n            } else if(accion==2){\n                this.adAccion=2;\n            } else{\n                this.adModal=0;\n            }\n        },\n        activarDesactivarCerrar(){\n            this.adModal=0;\n        },\n        activar(){\n            let me=this;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};\n            axios.put('venta/activate',{'_id':this.adId},configuracion)\n                .then(function(response){\n                    me.adModal=0;\n                    me.adAccion=0;\n                    me.adNombre='';\n                    me.adId='';\n                    me.listar();\n                })\n                .catch(function(error){\n                    console.log(error);\n                });\n        },\n        desactivar(){\n            let me=this;\n            let header={\"Token\" : this.$store.state.token};\n            let configuracion= {headers : header};\n            axios.put('venta/deactivate',{'_id':this.adId},configuracion)\n                .then(function(response){\n                    me.adModal=0;\n                    me.adAccion=0;\n                    me.adNombre='';\n                    me.adId='';\n                    me.listar();\n                })\n                .catch(function(error){\n                    console.log(error);\n                });\n        },\n        close () {\n            this.dialog = false;\n        }\n    }\n}\n",{"version":3,"sources":["Venta.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Venta.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <v-layout align-start>\r\n        <v-flex>\r\n            <v-toolbar flat color=\"white\">\r\n                <v-toolbar-title>Ventas</v-toolbar-title>\r\n                <v-divider\r\n                class=\"mx-2\"\r\n                inset\r\n                vertical\r\n                ></v-divider>\r\n                <v-spacer></v-spacer>\r\n                <v-text-field v-if=\"verNuevo==0\" class=\"text-xs-center\" v-model=\"search\" append-icon=\"search\" \r\n                label=\"Búsqueda\" single-line hide-details></v-text-field>\r\n                <v-spacer></v-spacer>\r\n                <v-btn color=\"primary\" v-if=\"verNuevo==0\" @click=\"mostrarNuevo()\" dark class=\"mb-2\">Nuevo</v-btn>\r\n                <v-dialog v-model=\"dialog\" max-width=\"1000px\">\r\n                    <v-card>\r\n                        <v-card-title> \r\n                            <span class=\"headline\">Seleccione un artículo</span>\r\n                        </v-card-title>            \r\n                        <v-card-text>\r\n                            <v-container grid-list-md>\r\n                                <v-layout wrap>\r\n                                    <v-flex xs12 sm12 md12 lg12 xl12>                                        \r\n                                        <v-text-field v-model=\"texto\" @keyup.enter=\"listarArticulos()\" class=\"text-xs-center\" append-icon=\"search\" \r\n                                        label=\"Búsqueda\"></v-text-field>\r\n                                        <template>\r\n                                            <v-data-table\r\n                                                :headers=\"cabeceraArticulos\"\r\n                                                :items=\"articulos\"\r\n                                                class=\"elevation-1\"\r\n                                            >\r\n                                                <template v-slot:items=\"props\">\r\n                                                <td class=\"justify-center layout px-0\">\r\n                                                    <v-icon\r\n                                                    small\r\n                                                    class=\"mr-2\"\r\n                                                    @click=\"agregarDetalle(props.item)\"\r\n                                                    >\r\n                                                    add\r\n                                                    </v-icon>                                                    \r\n                                                </td>\r\n                                                <td>{{ props.item.codigo }}</td>\r\n                                                <td>{{ props.item.nombre }}</td>\r\n                                                <td>{{ props.item.categoria.nombre }}</td>\r\n                                                <td>{{ props.item.stock }}</td>\r\n                                                <td>{{ props.item.precio_venta }}</td>\r\n                                                <td>{{ props.item.descripcion }}</td>\r\n                                                <td>\r\n                                                    <div v-if=\"props.item.estado\">\r\n                                                        <span class=\"blue--text\">Activo</span>\r\n                                                    </div>\r\n                                                    <div v-else>\r\n                                                        <span class=\"red--text\">Inactivo</span>\r\n                                                    </div>\r\n                                                </td>                \r\n                                                </template>\r\n                                            </v-data-table>\r\n                                        </template>\r\n                                    </v-flex>\r\n                                </v-layout>\r\n                            </v-container>\r\n                        </v-card-text>            \r\n                        <v-card-actions>\r\n                        <v-spacer></v-spacer>\r\n                            <v-btn color=\"blue darken-1\" flat @click=\"close\">Cancelar</v-btn>\r\n                        </v-card-actions>\r\n                    </v-card>\r\n                </v-dialog>\r\n                <v-dialog v-model=\"adModal\" max-width=\"290\">\r\n                    <v-card>\r\n                        <v-card-title class=\"headline\" v-if=\"adAccion==1\">\r\n                            Activar Item\r\n                        </v-card-title>\r\n                        <v-card-title class=\"headline\" v-if=\"adAccion==2\">\r\n                            Desactivar Item\r\n                        </v-card-title>\r\n                        <v-card-text>\r\n                            Estás a punto de <span v-if=\"adAccion==1\">activar </span>\r\n                            <span v-if=\"adAccion==2\">desactivar </span> el item {{adNombre}}\r\n                        </v-card-text>\r\n                        <v-card-actions>\r\n                            <v-spacer></v-spacer>\r\n                            <v-btn @click=\"activarDesactivarCerrar()\" color=\"green darken-1\" flat=\"flat\">\r\n                                Cancelar\r\n                            </v-btn>\r\n                            <v-btn v-if=\"adAccion==1\" @click=\"activar()\" color=\"orange darken-4\" flat=\"flat\">\r\n                                Activar\r\n                            </v-btn>\r\n                            <v-btn v-if=\"adAccion==2\" @click=\"desactivar()\" color=\"orange darken-4\" flat=\"flat\">\r\n                                Desactivar\r\n                            </v-btn>\r\n                        </v-card-actions>\r\n                    </v-card>\r\n                </v-dialog>\r\n                <v-dialog v-model=\"comprobanteModal\" max-width=\"1000px\">\r\n                    <v-card>\r\n                        <v-card-title class=\"headline\">\r\n                            <v-btn @click=\"crearPDF()\"><v-icon>print</v-icon></v-btn> Reporte de venta\r\n                        </v-card-title>\r\n\r\n                        <v-card-text>\r\n                            <div id=\"factura\">\r\n                                <header>\r\n                                    <div id=\"logo\">\r\n                                        <img src=\"data:image/png;base64,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\" id=\"imagen\">\r\n                                    </div>\r\n                                    <div id=\"datos\">\r\n                                        <p id=\"encabezado\">\r\n                                            <b>IncanatoIT</b>\r\n                                            <br>José Gálvez 1368, Chongoyape - Chiclayo, Perú<br>Telefono:(+51)931742904<br>Email:jcarlos.ad7@gmail.com\r\n                                        </p>\r\n                                    </div>\r\n                                    <div id=\"fact\">\r\n                                        <p>{{tipo_comprobante}}<br>\r\n                                        {{serie_comprobante}}-{{num_comprobante}}<br>\r\n                                        {{fecha}}</p>\r\n                                    </div>\r\n                                </header>\r\n                                <br>\r\n                                <section>\r\n                                    <div>\r\n                                        <table id=\"facliente\">\r\n                                            <tbody>\r\n                                                <tr>\r\n                                                    <td id=\"cliente\">\r\n                                                        <strong>Sr(a). {{persona.nombre}}</strong><br>\r\n                                                        <strong>Documento:</strong> {{persona.num_documento}}<br>\r\n                                                        <strong>Dirección:</strong> {{persona.direccion}}<br>\r\n                                                        <strong>Teléfono:</strong> {{persona.telefono}}<br>\r\n                                                        <strong>Email:</strong> {{persona.email}}\r\n                                                    </td>\r\n                                                </tr>\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n                                </section>\r\n                                <br>\r\n                                <section>\r\n                                    <div>\r\n                                        <table id=\"facarticulo\">\r\n                                            <thead>\r\n                                                <tr id=\"fa\">\r\n                                                    <th>CANT</th>\r\n                                                    <th>DESCRIPCION</th>\r\n                                                    <th>PRECIO UNIT</th>\r\n                                                    <th>DESC.</th>\r\n                                                    <th>PRECIO TOTAL</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                <tr v-for=\"det in detalles\" :key=\"det._id\">\r\n                                                    <td style=\"text-align:center;\">{{det.cantidad}}</td>\r\n                                                    <td>{{det.articulo}}</td>\r\n                                                    <td style=\"text-align:right;\">{{det.precio}}</td>\r\n                                                    <td style=\"text-align:right;\">{{det.descuento}}</td>\r\n                                                    <td style=\"text-align:right;\">{{(det.cantidad*det.precio)-det.descuento}}</td>\r\n                                                </tr>\r\n                                            </tbody>\r\n                                            <tfoot>\r\n                                                <tr>\r\n                                                    <th></th>\r\n                                                    <th></th>\r\n                                                    <th></th>\r\n                                                    <th style=\"text-align:right;\">SUBTOTAL</th>\r\n                                                    <th style=\"text-align:right;\">$ {{totalParcial=(total-totalImpuesto).toFixed(2)}}</th>\r\n                                                </tr>\r\n                                                <tr>\r\n                                                    <th></th>\r\n                                                    <th></th>\r\n                                                    <th></th>\r\n                                                    <th style=\"text-align:right;\">IVA({{impuesto}}%)</th>\r\n                                                    <th style=\"text-align:right;\">$ {{totalImpuesto=((total*impuesto)/(1+impuesto)).toFixed(2)}}</th>\r\n                                                </tr>\r\n                                                <tr>\r\n                                                    <th></th>\r\n                                                    <th></th>\r\n                                                    <th></th>\r\n                                                    <th style=\"text-align:right;\">TOTAL</th>\r\n                                                    <th style=\"text-align:right;\">$ {{total=calcularTotal}}</th>\r\n                                                </tr>\r\n                                            </tfoot>\r\n                                        </table>\r\n                                    </div>\r\n                                </section>\r\n                                <br>\r\n                                <br>\r\n                                <footer>\r\n                                    <div id=\"gracias\">\r\n                                        <p><b>Gracias por su compra!</b></p>\r\n                                    </div>\r\n                                </footer>\r\n                            </div>\r\n                        </v-card-text>\r\n\r\n                        <v-card-actions>\r\n                            <v-btn @click=\"ocultarComprobante()\" color=\"blue darken-1\" flat>Cancelar</v-btn>\r\n                        </v-card-actions>\r\n                    </v-card>\r\n                </v-dialog>\r\n            </v-toolbar>\r\n            <v-data-table\r\n                :headers=\"headers\"\r\n                :items=\"ventas\"\r\n                :search=\"search\"\r\n                class=\"elevation-1\"\r\n                v-if=\"verNuevo==0\"\r\n            >\r\n                <template v-slot:items=\"props\">\r\n                    <td class=\"justify-center layout px-0\">\r\n                        <v-icon small class=\"mr-2\" @click=\"verIngreso(props.item)\">\r\n                            tab\r\n                        </v-icon>\r\n                        <v-icon small class=\"mr-2\" @click=\"mostrarComprobante(props.item)\">\r\n                            print\r\n                        </v-icon>\r\n                        <template v-if=\"props.item.estado\">\r\n                            <v-icon\r\n                            small\r\n                            @click=\"activarDesactivarMostrar(2,props.item)\"\r\n                            >\r\n                            block\r\n                            </v-icon>\r\n                        </template>\r\n                        <template v-else>\r\n                            <v-icon\r\n                            small\r\n                            @click=\"activarDesactivarMostrar(1,props.item)\"\r\n                            >\r\n                            check\r\n                            </v-icon>\r\n                        </template>\r\n                    </td>\r\n                    <td>{{ props.item.usuario.nombre }}</td>\r\n                    <td>{{ props.item.persona.nombre }}</td>\r\n                    <td>{{ props.item.tipo_comprobante }}</td>\r\n                    <td>{{ props.item.serie_comprobante }}</td>\r\n                    <td>{{ props.item.num_comprobante }}</td>\r\n                    <td>{{ props.item.createdAt }}</td>\r\n                    <td>{{ props.item.impuesto }}</td>\r\n                    <td>{{ props.item.total }}</td>\r\n                    <td>\r\n                        <div v-if=\"props.item.estado\">\r\n                            <span class=\"blue--text\">Aceptado</span>\r\n                        </div>\r\n                        <div v-else>\r\n                            <span class=\"red--text\">Anulado</span>\r\n                        </div>\r\n                    </td>                \r\n                    </template>\r\n                    <template v-slot:no-data>\r\n                    <v-btn color=\"primary\" @click=\"listar()\">Resetear</v-btn>\r\n                </template>\r\n            </v-data-table>\r\n            <v-container grid-list-sm class=\"pa-4 white\" v-if=\"verNuevo\">\r\n                <v-layout row wrap>\r\n                    <v-flex xs12 sm4 md4 lg4 xl4>\r\n                        <v-select v-model=\"tipo_comprobante\" \r\n                        :items=\"comprobantes\" label=\"Tipo Comprobante\">\r\n                        </v-select>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm4 md4 lg4 xl4>\r\n                        <v-text-field v-model=\"serie_comprobante\" label=\"Serie Comprobante\">\r\n                        </v-text-field>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm4 md4 lg4 xl4>\r\n                        <v-text-field v-model=\"num_comprobante\" label=\"Número Comprobante\">\r\n                        </v-text-field>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm8 md8 lg8 xl8>\r\n                        <v-autocomplete :items=\"personas\" v-model=\"persona\" label=\"Cliente\">\r\n                        </v-autocomplete>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm4 md4 lg4 xl4>\r\n                        <v-text-field type=\"number\" v-model=\"impuesto\" label=\"Impuesto\">\r\n                        </v-text-field>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm8 md8 lg8 x8>\r\n                        <v-text-field v-model=\"codigo\" label=\"Código\" @keyup.enter=\"buscarCodigo()\">\r\n                        </v-text-field>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm2 md2 lg2 xl2>\r\n                        <v-btn small fab dark color=\"teal\" @click=\"mostrarModalArticulos()\">\r\n                            <v-icon dark>list</v-icon>\r\n                        </v-btn>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm2 md2 lg2 xl2 v-show=\"errorArticulo\">\r\n                        <div class=\"red--text\" v-text=\"errorArticulo\">\r\n\r\n                        </div>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm12 md12 lg12 xl12>\r\n                        <template>\r\n                            <v-data-table\r\n                                :headers=\"cabeceraDetalles\"\r\n                                :items=\"detalles\"\r\n                                hide-actions\r\n                                class=\"elevation-1\"\r\n                            >\r\n                                <template slot=\"items\" slot-scope=\"props\">\r\n                                    <td>\r\n                                        <v-icon\r\n                                        small\r\n                                        class=\"mr-2\"\r\n                                        @click=\"eliminarDetalle(detalles,props.item)\"\r\n                                        >\r\n                                        delete\r\n                                        </v-icon>\r\n                                    </td>\r\n                                    <td class=\"text-xs-center\">{{ props.item.articulo }}</td>\r\n                                    <td class=\"text-xs-center\"><v-text-field v-model=\"props.item.cantidad\" type=\"number\"></v-text-field></td>\r\n                                    <td class=\"text-xs-center\"><v-text-field v-model=\"props.item.precio\" type=\"number\"></v-text-field></td>\r\n                                    <td class=\"text-xs-center\"><v-text-field v-model=\"props.item.descuento\" type=\"number\"></v-text-field></td>\r\n                                    <td class=\"text-xs-right\">$ {{ (props.item.cantidad * props.item.precio)-props.item.descuento}}</td>\r\n                                </template>\r\n                                <template slot=\"no-data\">\r\n                                    <h3>No hay artículos agregados al detalle.</h3>\r\n                                </template>\r\n                            </v-data-table>\r\n                            <v-flex class=\"text-xs-right\">\r\n                                <strong>Total Parcial:</strong> $ \r\n                                {{totalParcial=(total-totalImpuesto).toFixed(2)}}\r\n                            </v-flex>\r\n                            <v-flex class=\"text-xs-right\">\r\n                                <strong>Total Impuesto:</strong> $ \r\n                                {{totalImpuesto=((total*impuesto)/(1+impuesto)).toFixed(2)}}\r\n                            </v-flex>\r\n                            <v-flex class=\"text-xs-right\">\r\n                                <strong>Total Neto:</strong> $ {{total=calcularTotal}}\r\n                            </v-flex>\r\n                        </template>\r\n                    </v-flex>\r\n                    <v-flex xs12 sm12 md12 v-show=\"valida\">\r\n                        <div class=\"red--text\" v-for=\"v in validaMensaje\" :key=\"v\" v-text=\"v\">\r\n\r\n                        </div>\r\n                    </v-flex>                    \r\n                    <v-flex xs12 sm12 md12 lg12 xl12>\r\n                        <v-btn color=\"blue darken-1\" flat @click.native=\"ocultarNuevo()\">Cancelar</v-btn>\r\n                        <v-btn color=\"success\" v-if=\"verDetalle==0\" @click.native=\"guardar()\">Guardar</v-btn>\r\n                    </v-flex>\r\n\t\t        </v-layout>\r\n            </v-container>\r\n        </v-flex>\r\n    </v-layout>\r\n</template>\r\n<script>\r\n    import axios from 'axios'\r\n    import jsPDF from 'jspdf'\r\n    import html2canvas from 'html2canvas';\r\n    export default {\r\n        data(){\r\n            return{\r\n                dialog: false,\r\n                search:'',\r\n                ventas:[],\r\n                headers: [\r\n                    { text: 'Opciones', value: 'opciones', sortable: false },\r\n                    { text: 'Usuario', value: 'usuario.nombre', sortable: true },\r\n                    { text: 'Cliente', value: 'persona.nombre', sortable: true },\r\n                    { text: 'Tipo Comprobante', value: 'tipo_comprobante', sortable: true },\r\n                    { text: 'Serie comprobante', value: 'serie_comprobante', sortable: false  },\r\n                    { text: 'Número comprobante', value: 'num_comprobante', sortable: false  },\r\n                    { text: 'Fecha', value: 'createdAt', sortable: false  },\r\n                    { text: 'Impuesto', value: 'impuesto', sortable: false  },\r\n                    { text: 'Total', value: 'total', sortable: false  },\r\n                    { text: 'Estado', value: 'estado', sortable: false  }                \r\n                ],\r\n                _id:'',\r\n                persona:'',\r\n                personas:[],\r\n                tipo_comprobante:'',\r\n                comprobantes: ['BOLETA','FACTURA','TICKET','GUIA'],\r\n                serie_comprobante:'',\r\n                num_comprobante: '',\r\n                impuesto: 0.18,\r\n                codigo:'',\r\n                cabeceraDetalles:[\r\n                    { text: 'Borrar', value: 'borrar', sortable: false },\r\n                    { text: 'Artículo', value: 'articulo', sortable: false },\r\n                    { text: 'Cantidad', value: 'cantidad', sortable: false },\r\n                    { text: 'Precio', value: 'precio', sortable: false },\r\n                    { text: 'Descuento', value: 'descuento', sortable: false },\r\n                    { text: 'Sub Total', value: 'subtotal', sortable: false  }\r\n                ],\r\n                detalles:[],\r\n                verNuevo:0,\r\n                errorArticulo:null,\r\n                total:0,\r\n                totalParcial:0,\r\n                totalImpuesto:0,\r\n                articulos:[],\r\n                texto:'',\r\n                cabeceraArticulos: [\r\n                    { text: 'Seleccionar', value: 'seleccionar', sortable: false },\r\n                    { text: 'Código',value: 'codigo', sortable: false},\r\n                    { text: 'Nombre',value: 'nombre', sortable: true},\r\n                    { text: 'Categoría',value: 'categoria.nombre', sortable: true},\r\n                    { text: 'Stock',value: 'stock', sortable: false},\r\n                    { text: 'Precio Venta',value: 'precio_venta', sortable: false},\r\n                    { text: 'Descripción', value: 'descripcion', sortable: false },              \r\n                    { text: 'Estado', value: 'estado', sortable: false }\r\n                ],\r\n                verDetalle:0,\r\n                valida:0,\r\n                validaMensaje:[],\r\n                adModal:0,\r\n                adAccion:0,\r\n                adNombre:'',\r\n                adId:'',\r\n                comprobanteModal:0,\r\n                fecha:null\r\n            }\r\n        },\r\n        computed: {\r\n            calcularTotal: function(){\r\n                let resultado=0.0;\r\n                for(var i=0;i<this.detalles.length;i++){\r\n                    resultado=resultado+((this.detalles[i].cantidad*this.detalles[i].precio)-this.detalles[i].descuento);\r\n                }\r\n                return resultado;\r\n            }\r\n        },\r\n        watch: {\r\n            dialog (val) {\r\n            val || this.close()\r\n            }\r\n        },\r\n        created () {\r\n            this.listar();\r\n            this.selectPersona();\r\n        },\r\n        methods: {\r\n            crearPDF(){\r\n                var quotes = document.getElementById('factura');\r\n                html2canvas(quotes).then(function (canvas) {\r\n                    var imgData = canvas.toDataURL('image/png');\r\n                    var imgWidth = 210;\r\n                    var pageHeight = 295;\r\n\r\n                    var imgHeight = canvas.height * imgWidth / canvas.width;\r\n                    var heightLeft = imgHeight;\r\n                    \r\n                    var doc = new jsPDF('p', 'mm', 'a4');\r\n                    var position = 0;\r\n\r\n                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\r\n                    heightLeft -= pageHeight;\r\n\r\n                    while (heightLeft >= 0) {\r\n                        position = heightLeft - imgHeight;\r\n                        doc.addPage();\r\n                        doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\r\n                        heightLeft -= pageHeight;\r\n                    }\r\n                    doc.save('ComprobanteVenta.pdf');\r\n                });\r\n            },\r\n            mostrarComprobante(item){\r\n                this.limpiar();\r\n                this.tipo_comprobante=item.tipo_comprobante;\r\n                this.serie_comprobante=item.serie_comprobante;\r\n                this.num_comprobante=item.num_comprobante;\r\n                this.fecha=item.createdAt;\r\n                this.persona=item.persona;\r\n                this.impuesto=item.impuesto;\r\n                this.listarDetalles(item._id);\r\n                this.comprobanteModal=1;\r\n            },\r\n            ocultarComprobante(){\r\n                this.comprobanteModal=0;\r\n            },\r\n            selectPersona(){\r\n                let me=this;\r\n                let personaArray=[];\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};            \r\n                axios.get('persona/listClientes',configuracion).then(function (response){\r\n                    personaArray=response.data;\r\n                    personaArray.map(function(x){\r\n                        me.personas.push({text:x.nombre, value:x._id});\r\n                    });\r\n                }).catch(function(error){\r\n                    console.log(error);\r\n                });\r\n            },\r\n            buscarCodigo(){\r\n                let me=this;\r\n                me.errorArticulo=null;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};            \r\n                axios.get('articulo/queryCodigo?codigo='+this.codigo,configuracion).then(function (response){\r\n                    me.agregarDetalle(response.data);\r\n                }).catch(function(error){\r\n                    me.errorArticulo='No existe el artículo.';\r\n                });\r\n            },\r\n            agregarDetalle(data){\r\n                this.errorArticulo=null;\r\n                if (this.encuentra(data._id)==true){\r\n                    this.errorArticulo='El artículo ya ha sido agregado.';\r\n                }\r\n                else{\r\n                    this.detalles.push(\r\n                        {\r\n                            _id:data._id,\r\n                            articulo:data.nombre,\r\n                            cantidad:1,\r\n                            precio:data.precio_venta,\r\n                            descuento:0\r\n                        }\r\n                    );\r\n                    this.codigo='';\r\n                }\r\n                \r\n            },\r\n            encuentra(id){\r\n                let sw=0;\r\n                for (var i=0;i<this.detalles.length;i++){\r\n                    if(this.detalles[i]._id==id){\r\n                        sw=true;\r\n                    }\r\n                }\r\n                return sw;\r\n            },\r\n            eliminarDetalle(arr,item){\r\n                let i=arr.indexOf(item);\r\n                if (i!= -1){\r\n                    arr.splice(i,1);\r\n                }\r\n            },\r\n            listarArticulos(){\r\n                let me=this;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};            \r\n                axios.get('articulo/list?valor='+this.texto,configuracion).then(function (response){\r\n                    console.log(response.data);\r\n                    me.articulos=response.data;\r\n                }).catch(function(error){\r\n                    console.log(error);\r\n                });\r\n            },\r\n            mostrarModalArticulos(){\r\n                this.dialog=1;\r\n            },\r\n            listarDetalles(id){\r\n                let me=this;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};            \r\n                axios.get('venta/query?_id='+id,configuracion).then(function (response){\r\n                    me.detalles=response.data.detalles;\r\n                }).catch(function(error){\r\n                    console.log(error);\r\n                });\r\n            },\r\n            verIngreso(item){\r\n                this.limpiar();\r\n                this.tipo_comprobante=item.tipo_comprobante;\r\n                this.serie_comprobante=item.serie_comprobante;\r\n                this.num_comprobante=item.num_comprobante;\r\n                this.persona=item.persona._id;\r\n                this.impuesto=item.impuesto;\r\n                this.listarDetalles(item._id);\r\n                this.verNuevo=1;\r\n                this.verDetalle=1;\r\n            },\r\n            listar(){\r\n                let me=this;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};            \r\n                axios.get('venta/list',configuracion).then(function (response){\r\n                    me.ventas=response.data;\r\n                }).catch(function(error){\r\n                    console.log(error);\r\n                });\r\n\r\n            },\r\n            limpiar(){\r\n                this._id='';\r\n                this.tipo_comprobante='';\r\n                this.serie_comprobante='';\r\n                this.num_comprobante='';\r\n                this.impuesto=0.18;\r\n                this.codigo='';\r\n                this.total=0;\r\n                this.totalParcial=0;\r\n                this.totalImpuesto=0;\r\n                this.detalles=[];\r\n                this.verNuevo=0;\r\n                this.valida=0;\r\n                this.validaMensaje=[];\r\n                this.verDetalle=0;\r\n            },\r\n            validar(){\r\n                this.valida=0;\r\n                this.validaMensaje=[];\r\n                if(!this.persona){\r\n                    this.validaMensaje.push('Seleccione un cliente.');\r\n                }\r\n                if(!this.tipo_comprobante){\r\n                    this.validaMensaje.push('Seleccione un tipo de comprobante.');\r\n                }\r\n                if(!this.num_comprobante){\r\n                    this.validaMensaje.push('Ingrese el número del comprobante.');\r\n                }\r\n                if(!this.impuesto || this.impuesto<0 || this.impuesto>1){\r\n                    this.validaMensaje.push('Ingrese un impuesto válido.');\r\n                }\r\n                if(this.detalles.length<=0){\r\n                    this.validaMensaje.push('Ingrese al menos un artículo al detalle');\r\n                }\r\n                if (this.validaMensaje.length){\r\n                    this.valida=1;\r\n                }\r\n                return this.valida;\r\n            },\r\n            mostrarNuevo(){\r\n                this.verNuevo=1;\r\n            },\r\n            ocultarNuevo(){\r\n                this.verNuevo=0;\r\n                this.limpiar();\r\n            },\r\n            guardar(){\r\n                let me=this;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};\r\n                if (this.validar()){\r\n                    return;\r\n                }\r\n                //Código para guardar\r\n                axios.post('venta/add',\r\n                {\r\n                    'persona':this.persona,\r\n                    'usuario':this.$store.state.usuario._id,\r\n                    'tipo_comprobante': this.tipo_comprobante,\r\n                    'serie_comprobante': this.serie_comprobante,\r\n                    'num_comprobante':this.num_comprobante,\r\n                    'impuesto': this.impuesto,\r\n                    'total':this.total,\r\n                    'detalles':this.detalles\r\n                },configuracion)\r\n                .then(function(response){\r\n                    me.limpiar();\r\n                    me.close();\r\n                    me.listar();\r\n                })\r\n                .catch(function(error){\r\n                    console.log(error);\r\n                });\r\n            },\r\n            activarDesactivarMostrar(accion,item){\r\n                this.adModal=1;\r\n                this.adNombre=item.num_comprobante;\r\n                this.adId=item._id;\r\n                if (accion==1){\r\n                    this.adAccion=1;\r\n                } else if(accion==2){\r\n                    this.adAccion=2;\r\n                } else{\r\n                    this.adModal=0;\r\n                }\r\n            },\r\n            activarDesactivarCerrar(){\r\n                this.adModal=0;\r\n            },\r\n            activar(){\r\n                let me=this;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};\r\n                axios.put('venta/activate',{'_id':this.adId},configuracion)\r\n                    .then(function(response){\r\n                        me.adModal=0;\r\n                        me.adAccion=0;\r\n                        me.adNombre='';\r\n                        me.adId='';\r\n                        me.listar();\r\n                    })\r\n                    .catch(function(error){\r\n                        console.log(error);\r\n                    });\r\n            },\r\n            desactivar(){\r\n                let me=this;\r\n                let header={\"Token\" : this.$store.state.token};\r\n                let configuracion= {headers : header};\r\n                axios.put('venta/deactivate',{'_id':this.adId},configuracion)\r\n                    .then(function(response){\r\n                        me.adModal=0;\r\n                        me.adAccion=0;\r\n                        me.adNombre='';\r\n                        me.adId='';\r\n                        me.listar();\r\n                    })\r\n                    .catch(function(error){\r\n                        console.log(error);\r\n                    });\r\n            },\r\n            close () {\r\n                this.dialog = false;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n<style>\r\n\t    #factura {\r\n            padding: 20px;\r\n            font-family: Arial, sans-serif;\r\n            font-size: 16px ;\r\n        }\r\n\r\n        #logo {\r\n            float: left;\r\n            margin-left: 2%;\r\n            margin-right: 2%;\r\n        }\r\n        #imagen {\r\n            width: 100px;\r\n        }\r\n\r\n        #fact {\r\n            font-size: 18px;\r\n            font-weight: bold;\r\n            text-align: center;\r\n        }   \r\n\r\n        #datos {\r\n            float: left;\r\n            margin-top: 0%;\r\n            margin-left: 2%;\r\n            margin-right: 2%;\r\n            /*text-align: justify;*/\r\n        }\r\n\r\n        #encabezado {\r\n            text-align: center;\r\n            margin-left: 10px;\r\n            margin-right: 10px;\r\n            font-size: 16px;\r\n        }\r\n\r\n        section {\r\n            clear: left;\r\n        }\r\n\r\n        #cliente {\r\n            text-align: left;\r\n        }\r\n\r\n        #facliente {\r\n            width: 40%;\r\n            border-collapse: collapse;\r\n            border-spacing: 0;\r\n            margin-bottom: 15px;\r\n        }\r\n\r\n        #fa {\r\n            color: #FFFFFF;\r\n            font-size: 14px;\r\n        }\r\n\r\n        #facarticulo {\r\n            width: 100%;\r\n            border-collapse: collapse;\r\n            border-spacing: 0;\r\n            padding: 20px;\r\n            margin-bottom: 15px;\r\n        }\r\n\r\n        #facarticulo thead {\r\n            padding: 20px;\r\n            background: #2183E3;\r\n            text-align: center;\r\n            border-bottom: 1px solid #FFFFFF;\r\n        }\r\n\r\n        #gracias {\r\n            text-align: center;\r\n        }\r\n</style>\r\n"]}]}